"use strict";(self.webpackChunkInstiKit=self.webpackChunkInstiKit||[]).push([[8613],{17595:(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});const r={components:{},data:function(){return{rollNumberForm:new Form({batch_id:"",students:[]},!1),batches:[],selected_batch:null,selected_batch_detail:{},student_records:[],autoRollNumberAssign:0,help_topic:""}},mounted:function(){helper.hasPermission("edit-roll-number")||(helper.notAccessibleMsg(),this.$router.push("/dashboard")),this.getPreRequisite(),helper.showDemoNotification(["student"])},methods:{getPreRequisite:function(){var t=this,e=this.$loading.show();axios.get("/api/student/roll/number/pre-requisite").then((function(s){t.batches=s.batches,e.hide()})).catch((function(t){e.hide(),helper.showErrorMsg(t)}))},getStudent:function(){var t=this,e=this.$loading.show();axios.post("/api/student/fetch",{batch_id:this.rollNumberForm.batch_id}).then((function(s){t.student_records=s.student_records,t.selected_batch_detail=s.batch,t.rollNumberForm.students=[],t.student_records.forEach((function(e){t.rollNumberForm.students.push({id:e.id,name:t.getStudentName(e.student),date_of_birth:e.student.date_of_birth,contact_number:e.student.contact_number,admission_number:helper.getAdmissionNumber(e.admission),father_name:e.student.parent.father_name,roll_number:e.roll_number})})),t.rollNumberForm.students.sort((function(t,e){var s=t.name.toUpperCase(),r=e.name.toUpperCase();return s<r?-1:s>r?1:0})),e.hide()})).catch((function(t){e.hide(),helper.showErrorMsg(t)}))},getStudentName:function(t){return helper.getStudentName(t)},getRollNumberName:function(t){return t+"_roll_number"},onBatchSelect:function(t){var e=this.$loading.show();this.rollNumberForm.batch_id=t.id,this.autoRollNumberAssign=0,this.getStudent(),e.hide()},onBatchRemove:function(t){this.rollNumberForm.batch_id="",this.rollNumberForm.students=[],this.student_records=[]},submit:function(){var t=this.$loading.show();this.rollNumberForm.post("/api/student/roll/number").then((function(e){toastr.success(e.message),t.hide()})).catch((function(e){t.hide(),helper.showErrorMsg(e)}))},autoAssign:function(){if(this.autoRollNumberAssign){var t=0;this.rollNumberForm.students.forEach((function(e){e.roll_number=++t}))}}},filters:{moment:function(t){return helper.formatDate(t)},momentDateTime:function(t){return helper.formatDateTime(t)}}};const o=(0,s(51900).Z)(r,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"page-titles"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-sm-6"},[e("h3",{staticClass:"text-themecolor"},[t._v(t._s(t.trans("student.roll_number")))])]),t._v(" "),e("div",{staticClass:"col-12 col-sm-6"},[e("div",{staticClass:"action-buttons pull-right"},[e("help-button",{on:{clicked:function(e){t.help_topic="registration"}}})],1)])])]),t._v(" "),e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body p-4"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)},keydown:function(e){return t.rollNumberForm.errors.clear(e.target.name)}}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-sm-3"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v(t._s(t.trans("academic.batch")))]),t._v(" "),e("v-select",{attrs:{label:"name","group-values":"batches","group-label":"course_group","group-select":!1,name:"batch_id",id:"batch_id",options:t.batches,placeholder:t.trans("academic.select_batch")},on:{select:t.onBatchSelect,close:function(e){return t.rollNumberForm.errors.clear("batch_id")},remove:t.onBatchRemove},model:{value:t.selected_batch,callback:function(e){t.selected_batch=e},expression:"selected_batch"}},[t.batches.length?t._e():e("div",{staticClass:"multiselect__option",attrs:{slot:"afterList"},slot:"afterList"},[t._v("\n\t\t\t\t\t\t                            "+t._s(t.trans("general.no_option_found"))+"\n\t\t\t\t\t\t                        ")])]),t._v(" "),e("show-error",{attrs:{"form-name":t.rollNumberForm,"prop-name":"batch_id"}})],1)]),t._v(" "),t.rollNumberForm.students.length?e("div",{staticClass:"col-12 col-sm-3"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Â ")]),t._v(" "),e("label",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.autoRollNumberAssign,expression:"autoRollNumberAssign"}],staticClass:"custom-control-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.autoRollNumberAssign)?t._i(t.autoRollNumberAssign,"1")>-1:t.autoRollNumberAssign},on:{change:[function(e){var s=t.autoRollNumberAssign,r=e.target,o=!!r.checked;if(Array.isArray(s)){var n=t._i(s,"1");r.checked?n<0&&(t.autoRollNumberAssign=s.concat(["1"])):n>-1&&(t.autoRollNumberAssign=s.slice(0,n).concat(s.slice(n+1)))}else t.autoRollNumberAssign=o},t.autoAssign]}}),t._v(" "),e("span",{staticClass:"custom-control-label"},[t._v(t._s(t.trans("student.auto_roll_number_assign")))])])])]):t._e()]),t._v(" "),t.rollNumberForm.students.length?e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-sm"},[e("thead",[e("tr",[e("th",[t._v(t._s(t.trans("student.admission_number_short")))]),t._v(" "),e("th",[t._v(t._s(t.trans("student.name")))]),t._v(" "),e("th",[t._v(t._s(t.trans("student.date_of_birth")))]),t._v(" "),e("th",[t._v(t._s(t.trans("student.contact_number")))]),t._v(" "),e("th",[t._v(t._s(t.trans("student.father_name")))]),t._v(" "),e("th",[t._v(t._s(t.trans("student.roll_number")))])])]),t._v(" "),e("tbody",t._l(t.rollNumberForm.students,(function(s,r){return e("tr",[e("td",{domProps:{textContent:t._s(s.admission_number)}}),t._v(" "),e("td",{domProps:{textContent:t._s(s.name)}}),t._v(" "),e("td",[t._v(t._s(t._f("moment")(s.date_of_birth)))]),t._v(" "),e("td",{domProps:{textContent:t._s(s.contact_number)}}),t._v(" "),e("td",{domProps:{textContent:t._s(s.father_name)}}),t._v(" "),e("td",[e("div",{staticClass:"form-group"},[e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[t._v(t._s(t.selected_batch_detail.options.roll_number_prefix))])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.roll_number,expression:"student.roll_number"}],staticClass:"form-control",attrs:{type:"text",name:t.getRollNumberName(r),placeholder:t.trans("student.roll_number")},domProps:{value:s.roll_number},on:{input:function(e){e.target.composing||t.$set(s,"roll_number",e.target.value)}}})]),t._v(" "),e("show-error",{attrs:{"form-name":t.rollNumberForm,"prop-name":t.getRollNumberName(r)}})],1)])])})),0)])]):t._e(),t._v(" "),t.rollNumberForm.students.length?e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"}},[t._v(t._s(t.trans("general.save")))])]):t._e()])])])])])]),t._v(" "),e("right-panel",{attrs:{topic:t.help_topic}})],1)}),[],!1,null,null,null).exports}}]);