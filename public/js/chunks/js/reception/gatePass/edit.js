"use strict";(self.webpackChunkInstiKit=self.webpackChunkInstiKit||[]).push([[7710],{18179:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});const a={components:{gatePassForm:s(90562).Z},data:function(){return{uuid:this.$route.params.uuid}},mounted:function(){helper.hasPermission("edit-gate-pass")||(helper.notAccessibleMsg(),this.$router.push("/dashboard"))}};const r=(0,s(51900).Z)(a,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"page-titles"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm-6"},[t("h3",{staticClass:"text-themecolor"},[e._v(e._s(e.trans("reception.edit_gate_pass")))])]),e._v(" "),t("div",{staticClass:"col-12 col-sm-6"},[t("div",{staticClass:"action-buttons pull-right"},[t("button",{staticClass:"btn btn-info btn-sm",on:{click:function(t){return e.$router.push("/reception/gate/pass")}}},[t("i",{staticClass:"fas fa-list"}),e._v(" "),t("span",{staticClass:"d-none d-sm-inline"},[e._v(e._s(e.trans("reception.gate_pass")))])])])])])]),e._v(" "),t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"card card-form"},[t("div",{staticClass:"card-body p-t-20"},[t("gate-pass-form",{attrs:{uuid:e.uuid}})],1)])])])}),[],!1,null,null,null).exports},90562:(e,t,s)=>{s.d(t,{Z:()=>r});const a={components:{},data:function(){return{gatePassForm:new Form({type:"student",student_id:"",employee_id:"",date:"",time:"",reason:""}),loaded:!1,time:{hour:"",minute:"",meridiem:"am"},students:[],selected_student:null,employees:[],selected_employee:null}},props:["uuid"],mounted:function(){helper.hasPermission("create-gate-pass")||helper.hasPermission("edit-gate-pass")||(helper.notAccessibleMsg(),this.$router.push("/dashboard")),this.uuid&&this.get(),this.getPreRequisite()},methods:{timePadding:function(e){return helper.formatWithPadding(e,2)},proceed:function(){this.uuid?this.update():this.store()},getPreRequisite:function(){var e=this,t=this.$loading.show();axios.get("/api/gate/pass/pre-requisite").then((function(s){e.students=s.students,e.employees=s.employees,e.gatePassForm.date=helper.today(),e.uuid||(e.loaded=!0),t.hide()})).catch((function(e){t.hide(),helper.showErrorMsg(e)}))},store:function(){var e=this;this.gatePassForm.time=this.time.hour&&this.time.minute?helper.formatWithPadding(this.time.hour,2)+":"+helper.formatWithPadding(this.time.minute,2)+" "+this.time.meridiem:"";var t=this.$loading.show();this.gatePassForm.post("/api/gate/pass").then((function(s){toastr.success(s.message),e.time.hour="",e.time.minute="",e.time.meridiem="am",e.gatePassForm.type="student",e.selected_student=null,e.selected_employee=null,e.$emit("completed"),t.hide()})).catch((function(e){t.hide(),helper.showErrorMsg(e)}))},get:function(){var e=this,t=this.$loading.show();axios.get("/api/gate/pass/"+this.uuid).then((function(s){e.gatePassForm.type=s.gate_pass.type,e.gatePassForm.reason=s.gate_pass.reason,e.gatePassForm.date=s.gate_pass.date,e.time.hour=s.time.hour,e.time.minute=s.time.minute,e.time.meridiem=s.time.meridiem,e.gatePassForm.student_id=s.gate_pass.student_id,e.selected_student=s.selected_student,e.gatePassForm.employee_id=s.gate_pass.employee_id,e.selected_employee=s.selected_employee,e.loaded=!0,t.hide()})).catch((function(s){t.hide(),helper.showErrorMsg(s),e.$router.push("/reception/gate/pass")}))},update:function(){var e=this;this.gatePassForm.time=this.time.hour&&this.time.minute?helper.formatWithPadding(this.time.hour,2)+":"+helper.formatWithPadding(this.time.minute,2)+" "+this.time.meridiem:"";var t=this.$loading.show();this.gatePassForm.patch("/api/gate/pass/"+this.uuid).then((function(s){toastr.success(s.message),t.hide(),e.$router.push("/reception/gate/pass")})).catch((function(e){t.hide(),helper.showErrorMsg(e)}))},onStudentSelect:function(e){return this.gatePassForm.student_id=e.id},onEmployeeSelect:function(e){return this.gatePassForm.employee_id=e.id}}};const r=(0,s(51900).Z)(a,(function(){var e=this,t=e._self._c;return t("form",{on:{submit:function(t){return t.preventDefault(),e.proceed.apply(null,arguments)},keydown:function(t){return e.gatePassForm.errors.clear(t.target.name)}}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm-3"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:""}},[e._v(e._s(e.trans("reception.gate_pass_type")))]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.gatePassForm.type,expression:"gatePassForm.type"}],staticClass:"custom-select col-12",on:{select:function(t){return e.gatePassForm.errors.clear("type")},change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.gatePassForm,"type",t.target.multiple?s:s[0])}}},[t("option",{attrs:{value:"student"}},[e._v(e._s(e.trans("student.student")))]),e._v(" "),t("option",{attrs:{value:"employee"}},[e._v(e._s(e.trans("employee.employee")))])]),e._v(" "),t("show-error",{attrs:{"form-name":e.gatePassForm,"prop-name":"type"}})],1)])]),e._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm-4"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:""}},[e._v(e._s(e.trans("reception.gate_pass_date")))]),e._v(" "),t("datepicker",{attrs:{bootstrapStyling:!0,placeholder:e.trans("reception.gate_pass_date")},on:{selected:function(t){return e.gatePassForm.errors.clear("date")}},model:{value:e.gatePassForm.date,callback:function(t){e.$set(e.gatePassForm,"date",t)},expression:"gatePassForm.date"}}),e._v(" "),t("show-error",{attrs:{"form-name":e.gatePassForm,"prop-name":"date"}})],1)]),e._v(" "),e.loaded?t("div",{staticClass:"col-12 col-sm-4"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:""}},[e._v(e._s(e.trans("reception.gate_pass_time")))]),e._v(" "),t("timepicker",{attrs:{hour:e.time.hour,minute:e.time.minute,meridiem:e.time.meridiem},on:{"update:hour":function(t){return e.$set(e.time,"hour",t)},"update:minute":function(t){return e.$set(e.time,"minute",t)},"update:meridiem":function(t){return e.$set(e.time,"meridiem",t)}}})],1)]):e._e(),e._v(" "),"student"==e.gatePassForm.type?t("div",{staticClass:"col-12 col-sm-3"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:""}},[e._v(e._s(e.trans("student.student")))]),e._v(" "),t("v-select",{attrs:{label:"name",name:"student_id",id:"student_id",options:e.students,placeholder:e.trans("student.select_student")},on:{select:e.onStudentSelect,close:function(t){return e.gatePassForm.errors.clear("student_id")},remove:function(t){e.gatePassForm.student_id=""}},model:{value:e.selected_student,callback:function(t){e.selected_student=t},expression:"selected_student"}},[e.students.length?e._e():t("div",{staticClass:"multiselect__option",attrs:{slot:"afterList"},slot:"afterList"},[e._v("\n                        "+e._s(e.trans("general.no_option_found"))+"\n                    ")])]),e._v(" "),t("show-error",{attrs:{"form-name":e.gatePassForm,"prop-name":"student_id"}})],1)]):e._e(),e._v(" "),"employee"==e.gatePassForm.type?t("div",{staticClass:"col-12 col-sm-3"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:""}},[e._v(e._s(e.trans("employee.employee")))]),e._v(" "),t("v-select",{attrs:{label:"name",name:"employee_id",id:"employee_id",options:e.employees,placeholder:e.trans("employee.select_employee")},on:{select:e.onEmployeeSelect,close:function(t){return e.gatePassForm.errors.clear("employee_id")},remove:function(t){e.gatePassForm.employee_id=""}},model:{value:e.selected_employee,callback:function(t){e.selected_employee=t},expression:"selected_employee"}},[e.employees.length?e._e():t("div",{staticClass:"multiselect__option",attrs:{slot:"afterList"},slot:"afterList"},[e._v("\n                        "+e._s(e.trans("general.no_option_found"))+"\n                    ")])]),e._v(" "),t("show-error",{attrs:{"form-name":e.gatePassForm,"prop-name":"employee_id"}})],1)]):e._e(),e._v(" "),t("div",{staticClass:"col-12"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:""}},[e._v(e._s(e.trans("reception.gate_pass_reason")))]),e._v(" "),t("autosize-textarea",{attrs:{rows:"1",name:"reason",placeholder:e.trans("reception.gate_pass_reason")},model:{value:e.gatePassForm.reason,callback:function(t){e.$set(e.gatePassForm,"reason",t)},expression:"gatePassForm.reason"}}),e._v(" "),t("show-error",{attrs:{"form-name":e.gatePassForm,"prop-name":"reason"}})],1)])]),e._v(" "),t("div",{staticClass:"card-footer text-right"},[t("router-link",{directives:[{name:"show",rawName:"v-show",value:e.uuid,expression:"uuid"}],staticClass:"btn btn-danger waves-effect waves-light",attrs:{to:"/reception/gate/pass"}},[e._v(e._s(e.trans("general.cancel")))]),e._v(" "),e.uuid?e._e():t("button",{staticClass:"btn btn-danger waves-effect waves-light",attrs:{type:"button"},on:{click:function(t){return e.$emit("cancel")}}},[e._v(e._s(e.trans("general.cancel")))]),e._v(" "),t("button",{staticClass:"btn btn-info waves-effect waves-light",attrs:{type:"submit"}},[e.uuid?t("span",[e._v(e._s(e.trans("general.update")))]):t("span",[e._v(e._s(e.trans("general.save")))])])],1)])}),[],!1,null,null,null).exports}}]);