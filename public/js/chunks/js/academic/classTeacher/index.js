"use strict";(self.webpackChunkInstiKit=self.webpackChunkInstiKit||[]).push([[5515],{64736:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});const a={components:{},data:function(){return{classTeacherForm:new Form({batches:[]},!1),batches:[],class_teachers:[],course_groups:[],edit_count:0,filter:{course_id:[],show_history:!0},showFilterPanel:!1,courses:[],selected_courses:null,help_topic:""}},mounted:function(){this.getDetail(),helper.showDemoNotification(["academic"])},methods:{getConfig:function(e){return helper.getConfig(e)},hasPermission:function(e){return helper.hasPermission(e)},getDetail:function(){var e=this,t=this.$loading.show(),s=helper.getFilterURL(this.filter);axios.get("/api/class/teacher?options=1"+s).then((function(s){e.batches=s.batches,e.course_groups=s.course_groups,e.courses=s.courses,e.classTeacherForm.batches=[],e.batches.forEach((function(t){e.classTeacherForm.batches.push({class_teachers:t.class_teachers,batch_id:t.id,course_id:t.course_id,name:t.course.name+" "+t.name,change:!1,date_effective:"",selected_employee:null,employee_id:"",description:"",show:!1})})),e.class_teachers=s.class_teachers,t.hide()})).catch((function(e){t.hide(),helper.showErrorMsg(e)}))},showAction:function(e){this.classTeacherForm.batches[e].show=!0},hideAction:function(e){this.classTeacherForm.batches[e].show=!1},getDateEffectiveFieldName:function(e){return e+"_date_effective"},getDescriptionFieldName:function(e){return e+"_description"},getEmployeeFieldName:function(e){return e+"_employee_id"},onEmployeeSelect:function(e,t){var s=t.split("_")[0];this.classTeacherForm.batches[s].employee_id=e.id},submit:function(){var e=this,t=this.$loading.show();this.classTeacherForm.post("/api/class/teacher").then((function(s){toastr.success(s.message),e.getDetail(),e.edit_count=0,t.hide()})).catch((function(e){t.hide(),helper.showErrorMsg(e)}))},getEmployeeName:function(e){return helper.getEmployeeNameWithCode(e)},showEditPanel:function(e){e.change=!0,this.edit_count++},hideEditPanel:function(e){e.change=!1,this.edit_count--},getCurrentClassTeacherName:function(e){var t=this.getCurrentClassTeacher(e);return void 0!==t?this.getEmployeeName(t.employee):"-"},getCurrentClassTeacherDesignation:function(e){var t=this.getCurrentClassTeacher(e);return t.length?helper.getEmployeeDesignationOnDate(t[0].employee,t.date_effective):""},getCurrentClassTeacher:function(e){var t=e.find((function(e){return e.date_effective<=helper.today()}));return void 0===t&&(t=e[0]),t},confirmDelete:function(e){var t=this;return function(s){return t.deleteClassTeacher(e)}},deleteClassTeacher:function(e){var t=this,s=this.$loading.show();axios.delete("/api/class/teacher/"+e.id).then((function(e){toastr.success(e.message),t.edit_count=0,t.getDetail(),s.hide()})).catch((function(e){s.hide(),helper.showErrorMsg(e)}))},print:function(){var e=this.$loading.show();axios.post("/api/class/teacher/print",{filter:this.filter}).then((function(t){var s=window.open("/print");e.hide(),s.document.write(t)})).catch((function(t){e.hide(),helper.showErrorMsg(t)}))},pdf:function(){var e=this,t=this.$loading.show();axios.post("/api/class/teacher/pdf",{filter:this.filter}).then((function(s){t.hide(),window.open("/download/report/"+s+"?token="+e.authToken)})).catch((function(e){t.hide(),helper.showErrorMsg(e)}))},onCourseSelect:function(e){this.filter.course_id.push(e.id)},onCourseRemove:function(e){this.filter.course_id.splice(this.filter.course_id.indexOf(e.id),1)},courseInFilterList:function(e){return!this.filter.course_id.length||this.filter.course_id.includes(e)},isRequired:function(e){var t=this;return e.courses.some((function(e){return!t.filter.course_id.length||t.filter.course_id.indexOf(e.id)>-1}))}},filters:{moment:function(e){return helper.formatDate(e)},momentDateTime:function(e){return helper.formatDateTime(e)}},computed:{authToken:function(){return helper.getAuthToken()}}},i=a;var o=(0,s(51900).Z)(i,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"page-titles"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm-6"},[t("h3",{staticClass:"text-themecolor"},[e._v(e._s(e.trans("academic.class_teacher"))+" ")])]),e._v(" "),t("div",{staticClass:"col-12 col-sm-6"},[t("div",{staticClass:"action-buttons pull-right"},[e.showFilterPanel?e._e():t("button",{staticClass:"btn btn-info btn-sm",on:{click:function(t){e.showFilterPanel=!e.showFilterPanel}}},[t("i",{staticClass:"fas fa-filter"}),e._v(" "),t("span",{staticClass:"d-none d-sm-inline"},[e._v(e._s(e.trans("general.filter")))])]),e._v(" "),t("div",{staticClass:"btn-group"},[t("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.trans("general.more_option"),expression:"trans('general.more_option')"}],staticClass:"btn btn-info btn-sm dropdown-toggle no-caret",attrs:{type:"button",role:"menu",id:"moreOption","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t("i",{staticClass:"fas fa-ellipsis-h"}),e._v(" "),t("span",{staticClass:"d-none d-sm-inline"})]),e._v(" "),t("div",{class:["dropdown-menu","ltr"==e.getConfig("direction")?"dropdown-menu-right":""],attrs:{"aria-labelledby":"moreOption"}},[t("button",{staticClass:"dropdown-item custom-dropdown",on:{click:e.print}},[t("i",{staticClass:"fas fa-print"}),e._v(" "+e._s(e.trans("general.print")))]),e._v(" "),t("button",{staticClass:"dropdown-item custom-dropdown",on:{click:e.pdf}},[t("i",{staticClass:"fas fa-file-pdf"}),e._v(" "+e._s(e.trans("general.generate_pdf")))])])]),e._v(" "),t("help-button",{on:{clicked:function(t){e.help_topic="academic.class-teacher"}}})],1)])])]),e._v(" "),t("div",{staticClass:"container-fluid"},[t("transition",{attrs:{name:"fade"}},[e.showFilterPanel?t("div",{staticClass:"card card-form"},[t("div",{staticClass:"card-body"},[t("h4",{staticClass:"card-title"},[e._v(e._s(e.trans("general.filter")))]),e._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm-4"},[t("div",{staticClass:"form-group"},[t("v-select",{attrs:{label:"name","track-by":"id","group-values":"courses","group-label":"course_group","group-select":!1,name:"course_id",id:"course_id",options:e.courses,placeholder:e.trans("academic.select_course"),multiple:!0,"close-on-select":!1,"clear-on-select":!1,"hide-selected":!0,selected:e.selected_courses},on:{select:e.onCourseSelect,remove:e.onCourseRemove},model:{value:e.selected_courses,callback:function(t){e.selected_courses=t},expression:"selected_courses"}},[e.courses.length?e._e():t("div",{staticClass:"multiselect__option",attrs:{slot:"afterList"},slot:"afterList"},[e._v("\n                                        "+e._s(e.trans("general.no_option_found"))+"\n                                    ")])])],1)]),e._v(" "),t("div",{staticClass:"col-12 col-sm-4"},[t("div",{staticClass:"form-group"},[t("switches",{staticClass:"m-t-10",attrs:{theme:"bootstrap",color:"success"},model:{value:e.filter.show_history,callback:function(t){e.$set(e.filter,"show_history",t)},expression:"filter.show_history"}}),e._v(" "+e._s(e.trans("academic.show_class_teacher_history"))+"\n                            ")],1)])]),e._v(" "),t("div",{staticClass:"card-footer text-right"},[t("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(t){e.showFilterPanel=!1}}},[e._v(e._s(e.trans("general.cancel")))]),e._v(" "),t("button",{staticClass:"btn btn-info waves-effect waves-light",attrs:{type:"button"},on:{click:e.getDetail}},[e._v(e._s(e.trans("general.filter")))])])])]):e._e()]),e._v(" "),t("div",{staticClass:"card p-4"},[t("div",{staticClass:"card-body font-80pc"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)},keydown:function(t){return e.classTeacherForm.errors.clear(t.target.name)}}},[e._l(e.course_groups,(function(s){return e.isRequired(s)?t("fieldset",{staticStyle:{border:"1px solid #f3f3f3","border-radius":"0.25rem","margin-bottom":"20px",padding:"20px 0 5px 0"}},[t("legend",{staticStyle:{border:"1px #f3f3f3 solid","margin-left":"20px",padding:"5px 10px",width:"auto","font-weight":"500","font-size":"16px"}},[e._v(e._s(s.name))]),e._v(" "),e._l(s.courses,(function(a){return e.courseInFilterList(a.id)?[t("h6",{staticClass:"card-title font-weight-bold m-l-20"},[e._v(e._s(a.name))]),e._v(" "),e._l(e.classTeacherForm.batches,(function(s,i){return s.course_id==a.id?t("div",{class:["row p-3",s.show?"hover":""],on:{mouseover:function(t){return e.showAction(i)},mouseout:function(t){return e.hideAction(i)}}},[t("div",{staticClass:"col-12 col-sm-4"},[e._v("\n                                    "+e._s(s.name)+"\n                                    "),t("span",{directives:[{name:"show",rawName:"v-show",value:e.hasPermission("store-class-teacher"),expression:"hasPermission('store-class-teacher')"}],staticClass:"m-l-10"},[s.change?e._e():t("i",{staticClass:"fas fa-edit opaque-on-hover",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.showEditPanel(s)}}}),e._v(" "),s.change?t("i",{staticClass:"fas fa-times-circle",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.hideEditPanel(s)}}}):e._e()])]),e._v(" "),t("div",{staticClass:"col-12 col-sm-4"},[s.class_teachers.length?t("span",[e._v("\n                                        "+e._s(e.getCurrentClassTeacherName(s.class_teachers))+" \n                                        "+e._s(e.getCurrentClassTeacherDesignation(s.class_teachers))+"\n                                        "),e.hasPermission("delete-class-teacher")?t("i",{directives:[{name:"show",rawName:"v-show",value:s.show,expression:"batch.show"},{name:"confirm",rawName:"v-confirm",value:{ok:e.confirmDelete(s.class_teachers[0])},expression:"{ok: confirmDelete(batch.class_teachers[0])}"},{name:"tooltip",rawName:"v-tooltip",value:e.trans("academic.delete_class_teacher"),expression:"trans('academic.delete_class_teacher')"}],key:s.class_teachers[0].id,staticClass:"fas fa-times-circle",staticStyle:{cursor:"pointer",color:"red"}}):e._e()]):t("span",[e._v("-")])]),e._v(" "),e.filter.show_history?t("div",{staticClass:"col-12 col-sm-4"},[s.class_teachers.length?t("ul",{staticStyle:{"list-style":"none",padding:"0",margin:"0"}},e._l(s.class_teachers,(function(s,a){return t("li",[e._v("\n                                            ("+e._s(a+1)+") \n                                            "+e._s(e.getEmployeeName(s.employee)+" "+e.trans("general.from"))+" "+e._s(e._f("moment")(s.date_effective))+" \n                                        ")])})),0):e._e(),e._v(" "),s.class_teachers.length?e._e():t("span",[e._v("-")])]):e._e(),e._v(" "),s.change?t("div",{staticClass:"col-12 my-4"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm-4"},[t("v-select",{attrs:{label:"name",name:e.getEmployeeFieldName(i),id:e.getEmployeeFieldName(i),options:e.class_teachers,placeholder:e.trans("academic.select_class_teacher")},on:{select:e.onEmployeeSelect,close:function(t){e.classTeacherForm.errors.clear(e.getEmployeeFieldName(i))},remove:function(e){s.employee_id=""}},model:{value:s.selected_employee,callback:function(t){e.$set(s,"selected_employee",t)},expression:"batch.selected_employee"}},[e.class_teachers.length?e._e():t("div",{staticClass:"multiselect__option",attrs:{slot:"afterList"},slot:"afterList"},[e._v("\n                                                "+e._s(e.trans("general.no_option_found"))+"\n                                            ")])]),e._v(" "),t("show-error",{attrs:{"form-name":e.classTeacherForm,"prop-name":e.getEmployeeFieldName(i)}})],1),e._v(" "),t("div",{staticClass:"col-12 col-sm-4"},[t("datepicker",{attrs:{bootstrapStyling:!0,name:e.getDateEffectiveFieldName(i),placeholder:e.trans("academic.date_effective")},on:{selected:function(t){e.classTeacherForm.errors.clear(e.getDateEffectiveFieldName(i))}},model:{value:s.date_effective,callback:function(t){e.$set(s,"date_effective",t)},expression:"batch.date_effective"}}),e._v(" "),t("show-error",{attrs:{"form-name":e.classTeacherForm,"prop-name":e.getDateEffectiveFieldName(i)}})],1),e._v(" "),t("div",{staticClass:"col-12 col-sm-4"},[t("autosize-textarea",{attrs:{rows:"1",name:e.getDescriptionFieldName(i),placeholder:e.trans("academic.class_teacher_description")},model:{value:s.description,callback:function(t){e.$set(s,"description",t)},expression:"batch.description"}}),e._v(" "),t("show-error",{attrs:{"form-name":e.classTeacherForm,"prop-name":e.getDescriptionFieldName(i)}})],1)])]):e._e()]):e._e()})),e._v(" "),e.$last(a,s.courses)?e._e():t("hr")]:e._e()}))],2):e._e()})),e._v(" "),e.edit_count?t("button",{staticClass:"btn btn-info waves-effect waves-light pull-right",attrs:{type:"submit"}},[e._v(e._s(e.trans("general.save")))]):e._e()],2)])])],1),e._v(" "),t("right-panel",{attrs:{topic:e.help_topic}})],1)}),[],!1,null,null,null);const r=o.exports}}]);